<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TOTOBAR</title>

<style>
body{
  margin:0;
  background:#050505;
  color:#f5d28a;
  font-family:Arial, sans-serif;
}

header{
  text-align:center;
  padding:25px 10px;
  background:#0b0b0b;
  border-bottom:3px solid #d4af37;
}

.logo{
  width:220px;
  display:block;
  margin:0 auto;
}

h2{
  margin-top:10px;
}

.section{
  display:none;
  padding:20px;
}

button{
  padding:14px 20px;
  border:none;
  border-radius:16px;
  background:linear-gradient(135deg,#d4af37,#b8860b);
  color:#000;
  font-weight:bold;
  margin:6px;
  cursor:pointer;
  min-width:120px;
  transition:0.2s;
  font-size:15px;
}

button:active{
  transform:scale(0.95);
}

.tabs{
  display:flex;
  flex-wrap:wrap;
  justify-content:center;
  margin-bottom:15px;
  position:sticky;
  top:0;
  background:#050505;
  padding:10px 0;
  z-index:10;
}

.card{
  background:#111;
  padding:15px;
  border-radius:14px;
  margin-bottom:12px;
  border:1px solid #222;
  transition:0.2s;
}

.card:hover{
  transform:scale(1.02);
}
</style>
</head>
<body>

<header>
  <img src="logo.png" class="logo">
  <h2>TOTOBAR</h2>
</header>

<!-- SELECTOR -->
<div id="selector" class="section" style="display:block;">
  <h3>Seleccionar modo</h3>
  <button onclick="login('cliente')">Cliente</button>
  <button onclick="login('mozo')">Mozo</button>
  <button onclick="login('cocina')">Cocina</button>
  <button onclick="login('admin')">Admin</button>
  <button onclick="login('dueno')">Due√±o</button>
</div>

<!-- CLIENTE SOLO VISUAL -->
<div id="cliente" class="section">
  <button onclick="mostrar('selector')">‚¨Ö Volver</button>
  <h3>Men√∫</h3>
  <div class="tabs" id="tabsCategorias"></div>
  <div id="productos"></div>
</div>

<!-- SONIDO -->
<audio id="clickSound" src="click.mp3"></audio>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";
import { getFirestore, collection, onSnapshot } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "TU_API_KEY",
  authDomain: "menu-pro-app.firebaseapp.com",
  projectId: "menu-pro-app",
  storageBucket: "menu-pro-app.firebasestorage.app",
  messagingSenderId: "42917274964",
  appId: "1:42917274964:web:3be3c9c124b9c69b8994c1"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

let categorias = [];
let productos = [];

// üîπ Cargar categor√≠as
function cargarCategorias(){
  onSnapshot(collection(db,"categorias"), snap=>{
    categorias=[];
    snap.forEach(d=>{
      categorias.push(d.data().nombre);
    });
    renderTabs();
  });
}

// üîπ Cargar productos una sola vez
function cargarProductos(){
  onSnapshot(collection(db,"productos"), snap=>{
    productos=[];
    snap.forEach(d=>{
      productos.push(d.data());
    });
  });
}

// üîπ Render botones categor√≠as
function renderTabs(){
  const tabs=document.getElementById("tabsCategorias");
  tabs.innerHTML="";
  categorias.forEach(cat=>{
    tabs.innerHTML+=`<button onclick="mostrarCat('${cat}')">${cat}</button>`;
  });
}

// üîπ Mostrar productos sin salto
window.mostrarCat = (cat)=>{
  const prodDiv=document.getElementById("productos");
  prodDiv.innerHTML="";

  productos.forEach(p=>{
    if(p.categoria === cat){
      prodDiv.innerHTML+=`
        <div class="card">
          <h4>${p.nombre}</h4>
          <p>$${p.precio}</p>
        </div>
      `;
    }
  });

  reproducirSonido();
};

// üîä Sonido
function reproducirSonido(){
  const audio = document.getElementById("clickSound");
  audio.currentTime = 0;
  audio.play();
}

window.login = (rol)=>{

  if(rol==="cliente"){
    mostrar("cliente");
    return;
  }

  const pass = prompt("Contrase√±a:");
  if(!pass) return;

  if(rol==="mozo" && pass==="mozo2026"){
    window.location.href="waiter.html";
    return;
  }

  if(rol==="cocina" && pass==="cocina2026"){
    window.location.href="kitchen.html";
    return;
  }

  if(rol==="admin" && pass==="toto321"){
    window.location.href="admin.html";
    return;
  }

  if(rol==="dueno" && pass==="toto321"){
    window.location.href="due√±o.html";
    return;
  }

  alert("Contrase√±a incorrecta");
};

window.mostrar = (id)=>{
  document.querySelectorAll(".section").forEach(s=>s.style.display="none");
  document.getElementById(id).style.display="block";
};

cargarCategorias();
cargarProductos();
</script>

</body>
</html>