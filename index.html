<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TOTOBAR</title>

<style>
body{
  background:#050505;
  color:#f5d28a;
  font-family:Arial;
  padding:14px;
  max-width:900px;
  margin:0 auto;
}

header{
  text-align:center;
}

.logo{
  width:280px;
}

h2{
  margin-bottom:20px;
}

/* SECCIONES */
.section{
  display:none;
  margin-bottom:32px;
}

/* BOTONES EXACTAMENTE IGUALES AL WAITER */
button{
  padding:14px 18px;
  font-size:18px;
  border:none;
  border-radius:12px;
  background:linear-gradient(145deg, #8a6a2f, #5f4a1a);
  color:white;
  font-weight:bold;
  box-shadow:0 4px 12px rgba(138,106,47,0.6);
  margin-top:10px;
  width:100%;
}

button:active{
  transform:scale(0.97);
}

/* GRILLA 3 EN 3 */
.tabs{
  display:grid;
  grid-template-columns:repeat(3, 1fr);
  gap:10px;
  justify-items:center;
  margin-bottom:20px;
}

.tabs button{
  width:100%;
  text-align:center;
}

/* TARJETAS */
.card{
  background:#101010;
  padding:18px;
  border-radius:16px;
  margin-bottom:20px;
  border:1px solid #2b2b2b;
  font-size:18px;
}
</style>
</head>
<body>

<header>
  <img src="logo.png" class="logo">
  <h2>TOTOBAR</h2>
</header>

<!-- SELECTOR -->
<div id="selector" class="section" style="display:block;">
  <h2>Seleccionar modo</h2>
  <div class="tabs">
    <button onclick="login('cliente')">Cliente</button>
    <button onclick="login('mozo')">Mozo</button>
    <button onclick="login('cocina')">Cocina</button>
    <button onclick="login('admin')">Admin</button>
    <button onclick="login('dueno')">Dueño</button>
  </div>
</div>

<!-- CLIENTE -->
<div id="cliente" class="section">
  <button onclick="mostrar('selector')">⬅ Volver</button>
  <h2>Menú</h2>
  <div class="tabs" id="tabsCategorias"></div>
  <div id="productos"></div>
</div>

<audio id="clickSound" src="click.mp3"></audio>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";
import { getFirestore, collection, onSnapshot } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey:"TU_API_KEY",
  authDomain:"menu-pro-app.firebaseapp.com",
  projectId:"menu-pro-app",
  storageBucket:"menu-pro-app.firebasestorage.app",
  messagingSenderId:"42917274964",
  appId:"1:42917274964:web:3be3c9c124b9c69b8994c1"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

let categorias = [];
let productos = [];

function cargarCategorias(){
  onSnapshot(collection(db,"categorias"), snap=>{
    categorias=[];
    snap.forEach(d=>categorias.push(d.data().nombre));
    renderTabs();
  });
}

function cargarProductos(){
  onSnapshot(collection(db,"productos"), snap=>{
    productos=[];
    snap.forEach(d=>productos.push(d.data()));
  });
}

function renderTabs(){
  const tabs=document.getElementById("tabsCategorias");
  tabs.innerHTML="";
  categorias.forEach(cat=>{
    tabs.innerHTML+=`<button onclick="mostrarCat('${cat}')">${cat}</button>`;
  });
}

window.mostrarCat=(cat)=>{
  const prodDiv=document.getElementById("productos");
  prodDiv.innerHTML="";

  productos.forEach(p=>{
    if(p.categoria===cat){
      prodDiv.innerHTML+=`
        <div class="card">
          <h3>${p.nombre}</h3>
          <p>$${p.precio}</p>
        </div>
      `;
    }
  });

  reproducirSonido();
};

function reproducirSonido(){
  const audio=document.getElementById("clickSound");
  audio.currentTime=0;
  audio.play();
}

window.login=(rol)=>{
  if(rol==="cliente"){
    mostrar("cliente");
    return;
  }

  const pass=prompt("Contraseña:");
  if(!pass) return;

  if(rol==="mozo" && pass==="mozo2026") window.location.href="waiter.html";
  else if(rol==="cocina" && pass==="cocina2026") window.location.href="kitchen.html";
  else if(rol==="admin" && pass==="toto321") window.location.href="admin.html";
  else if(rol==="dueno" && pass==="toto321") window.location.href="dueño.html";
  else alert("Contraseña incorrecta");
};

window.mostrar=(id)=>{
  document.querySelectorAll(".section").forEach(s=>s.style.display="none");
  document.getElementById(id).style.display="block";
};

cargarCategorias();
cargarProductos();
</script>

</body>
</html>