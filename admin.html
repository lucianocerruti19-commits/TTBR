<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin</title>

<style>
body{
  background:#050505;
  color:#f5d28a;
  font-family:Arial;
  padding:14px;
}

.card{
  background:#101010;
  border:1px solid #2b2b2b;
  padding:16px;
  border-radius:16px;
  margin-bottom:16px;
}

button{
  padding:12px;
  border:none;
  border-radius:12px;
  background:linear-gradient(145deg, #d8b14a, #b58c2f);
  color:black;
  font-weight:bold;
}
</style>
</head>
<body>

<h1>Panel Admin</h1>

<audio id="click" src="https://actions.google.com/sounds/v1/alarms/beep_short.ogg"></audio>

<div id="pedidos"></div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";
import { getFirestore, collection, onSnapshot, deleteDoc, doc } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyCa-R6z76qoMt6Wf9EZFSqqGNY8U4JUMtM",
  authDomain: "menu-pro-app.firebaseapp.com",
  projectId: "menu-pro-app",
  storageBucket: "menu-pro-app.firebasestorage.app",
  messagingSenderId: "42917274964",
  appId: "1:42917274964:web:3be3c9c124b9c69b8994c1"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
const click = document.getElementById("click");

/* SONIDO EN BOTONES */
document.addEventListener("click", e=>{
  if(e.target.tagName === "BUTTON") click.play();
});

/* PEDIDOS DETALLE */
onSnapshot(collection(db,"pedidos"), snap=>{
  const cont = document.getElementById("pedidos");
  cont.innerHTML = "";

  snap.forEach(d=>{
    const p = d.data();

    cont.innerHTML += `
    <div class="card">
      <h3>Mesa ${p.mesa}</h3>
      <p><strong>Estado:</strong> ${p.estado}</p>
      <p><strong>Mozo:</strong> ${p.mozo || "—"}</p>
      <p><strong>Mozo cobro:</strong> ${p.mozoCobro || "—"}</p>
      <p><strong>Total:</strong> $${p.total}</p>
      <p><strong>Nota:</strong> ${p.nota || "sin nota"}</p>
      <p><strong>Items:</strong><br>
        ${(p.items||[]).map(i=>`${i.prod} - $${i.precio}`).join("<br>")}
      </p>
      <button onclick="eliminar('${d.id}')">Eliminar</button>
    </div>`;
  });
});

/* ELIMINAR */
window.eliminar = async (id) => {
  if(!confirm("Eliminar?")) return;
  await deleteDoc(doc(db,"pedidos",id));
};
</script>
</body>
</html>