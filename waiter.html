<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mozo</title>

<style>
body{
  background:#050505;
  color:#f5d28a;
  font-family:Arial;
  padding:12px;
}

.card{
  background:#101010;
  border:1px solid #2b2b2b;
  padding:14px;
  border-radius:14px;
  margin-bottom:14px;
}

button{
  padding:12px;
  border:none;
  border-radius:12px;
  background:linear-gradient(145deg, #d8b14a, #b58c2f);
  color:black;
  font-weight:bold;
}
</style>
</head>
<body>

<h1>Panel Mozo</h1>

<div id="pedidos"></div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";
import { getFirestore, collection, onSnapshot, updateDoc, doc } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyCa-R6z76qoMt6Wf9EZFSqqGNY8U4JUMtM",
  authDomain: "menu-pro-app.firebaseapp.com",
  projectId: "menu-pro-app",
  storageBucket: "menu-pro-app.firebasestorage.app",
  messagingSenderId: "42917274964",
  appId: "1:42917274964:web:3be3c9c124b9c69b8994c1"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
const contenedor = document.getElementById("pedidos");

/* VIBRACIÃ“N */
function vibrar(){
  if("vibrate" in navigator) navigator.vibrate([300,200,300]);
}

/* PEDIDOS LISTOS */
onSnapshot(collection(db,"pedidos"), snap=>{
  contenedor.innerHTML = "";

  snap.forEach(d=>{
    const data = d.data();

    if(data.estado === "listo"){
      vibrar();

      contenedor.innerHTML += `
      <div class="card">
        <h3>Mesa ${data.mesa}</h3>
        <p><strong>Items:</strong><br>
          ${(data.items||[]).map(i=>`${i.prod} - $${i.precio}`).join("<br>")}
        </p>
        <p><strong>Estado:</strong> ${data.estado}</p>

        <button onclick="entregar('${d.id}')">Entregado</button>
      </div>`;
    }
  });
});

/* ENTREGAR */
window.entregar = async (id) => {
  await updateDoc(doc(db,"pedidos",id),{estado:"entregado"});
};
</script>
</body>
</html>