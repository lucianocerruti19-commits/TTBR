onSnapshot(collection(db,"pedidos"), snap=>{
  const pend = document.getElementById("pendientes");
  const cont = document.getElementById("mesas");

  pend.innerHTML = "";
  cont.innerHTML = "";

  snap.forEach(d=>{
    const data = d.data();

    /* PEDIDOS DEL CLIENTE QUE MOZO DEBE CONFIRMAR */
    if(data.creadoPor === "cliente" && data.estado === "pendiente_mozo"){
      pend.innerHTML += `
      <div class="card">
        <h3>Mesa: ${data.mesa || "sin mesa"}</h3>
        <p>Total: $${data.total}</p>
        <p>Nota: ${data.nota || "sin nota"}</p>

        <input id="mesa-${d.id}" placeholder="Asignar mesa">
        <button onclick="confirmar('${d.id}')">Confirmar pedido</button>
      </div>`;
    }

    /* PEDIDOS EN COCINA O LISTOS (se muestran) */
    if(data.estado && data.estado !== "pagado"){
      cont.innerHTML += `
      <div class="card">
        <h3>Mesa ${data.mesa}</h3>
        <p><strong>Estado:</strong> ${data.estado}</p>
        <p><strong>Total:</strong> $${data.total}</p>
        <p><strong>Items:</strong><br>
          ${(data.items||[]).map(i=>`${i.prod} - $${i.precio}`).join("<br>")}
        </p>

        <input id="cobro-${d.id}" placeholder="Nombre del mozo que cobra">
        <button onclick="cobrar('${d.id}')">ðŸ’² Cobrar</button>
      </div>`;
    }
  });
});