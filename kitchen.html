<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Cocina</title>
<style>
body{
  background:#000;
  color:#d4af37;
  font-family:Arial;
  padding:10px;
  transition: background 0.8s;
}
.dorado{
  background:#d4af37 !important;
  color:black !important;
}
.card{
  background:#0c0c0c;
  border:1px solid rgba(212,175,55,0.4);
  padding:15px;
  border-radius:14px;
  margin-bottom:15px;
}
button{
  width:100%;
  padding:10px;
  margin-top:8px;
  border:none;
  border-radius:8px;
  font-weight:bold;
  background:#d4af37;
  color:black;
  cursor:pointer;
}
</style>
</head>
<body>

<h1>Cocina</h1>
<audio id="alerta" src="https://actions.google.com/sounds/v1/alarms/beep_short.ogg"></audio>
<div id="pedidos"></div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";
import { getFirestore, collection, onSnapshot, doc, updateDoc } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-firestore.js";

const firebaseConfig={/* tu config */};
const app=initializeApp(firebaseConfig);
const db=getFirestore(app);
const cont=document.getElementById("pedidos");
const sonido=document.getElementById("alerta");

function sonidoClick(){
  new Audio("https://actions.google.com/sounds/v1/alarms/beep_short.ogg").play();
}

function dorado(){
  document.body.classList.add("dorado");
  setTimeout(()=>document.body.classList.remove("dorado"),1500);
}

/* PEDIDOS */
onSnapshot(collection(db,"pedidos"),snap=>{
  cont.innerHTML="";

  snap.forEach(d=>{
    const data=d.data();

    if(data.estado === "pendiente"){
      sonido.play();

      cont.innerHTML+=`
      <div class="card">
        <h3>Mesa ${data.mesa}</h3>
        <p><strong>Mozo:</strong> ${data.mozo}</p>
        <p><strong>Nota:</strong> ${data.nota || "sin nota"}</p>
        <p><strong>Items:</strong><br>
          ${(data.items||[]).map(i=>`${i.prod} - $${i.precio}`).join("<br>")}
        </p>
        <button onclick="marcar('${d.id}')">LISTO</button>
      </div>`;
    }
  });
});

/* LISTO */
window.marcar=async(id)=>{
  await updateDoc(doc(db,"pedidos",id),{estado:"listo"});
  sonidoClick();
  dorado();

  // aviso al mozo (si est√° abierto)
  localStorage.setItem("pedidoListo", id);
};
</script>
</body>
</html>